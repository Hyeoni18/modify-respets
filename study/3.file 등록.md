file 등록

1. pom.xml 추가

```xml
<!-- https://mvnrepository.com/artifact/commons-fileupload/commons-fileupload -->
<dependency>
    <groupId>commons-fileupload</groupId>
    <artifactId>commons-fileupload</artifactId>
    <version>1.3.3</version>
</dependency>
<dependency>
    <groupId>commons-io</groupId>
    <artifactId>commons-io</artifactId>
    <version>2.6</version>
</dependency>
```

**파일 업로드시 라이브러리를 사용하는 이유**

`JSP/Servlet` 환경에서 파일을 업로드할때에는 오픈소스 라이브러리를 사용합니다. 왜냐하면 서버입장에서는 평소에 쿼리스트링을 통해 넘어오는 파라미터와는 다르게, 클라이언트가 HTTP 요청메시지의 몸체에 `multipart` 형태로 업로드한 파일의 바이너리 데이터를 입력 스트림을 통해 읽어들여 각각 잘라서 가공한 다음 사용해야 하는데, 매우 번거로운 일이기 때문입니다. 물론 세밀한 조작이나 파일업로드 라이브러리를 직접 개발하기 위해서는 이러한 과정을 직접 개발해야 할 것입니다. 그러나 시간이 없는 우리 일반 웹개발자들에겐 좋은 오픈소스 라이브러리들이 있습니다. 최근 버전의`Servlet3.0` 환경에서는 `Part` 라는 API가 제공되기 때문에 그것을 사용해도 되지만 그 이전버전이라면 `Apache Commons`의 `FileUpload` 라이브러리가 많이 사용됩니다. (https://dololak.tistory.com/721 )



2. servlet-context.xml 설정

```xml
<!-- MultipartResolver 설정 -->
<beans:bean id="multipartResolver"
            class="org.springframework.web.multipart.commons.CommonsMultipartResolver">
</beans:bean>
```

MultipartResolver는 Multipart 형태로 업로드된 파일을 스프링에서 사용할 수 있도록 변환해준다.

Multipart ; 웹 클라이언트가 서버에세 파일을 업로드할 때, http 프로토콜의 바디 부분에 파일정보를 담아서 전송한다. 파일을 한번에 여러개 전송하면 body 부분에 파일이 여러개의 부분으로 연결되어 전송된다. 데이터를 여러 부분으로 나눠서 보내는 것이 Multipart data 이다. (https://codingnotes.tistory.com/73)



3. 파일 업로드

```jsp
<!-- form 태그 활용 -->
<form action="" enctype="multipart/form-data" method="post">

<!-- ajax 활용 -->
<script>    
enctype: 'multipart/form-data',
processData: false,
contentType: false,
data: formData
</script>
```

enctype ; 기본값은 application/x-www-form/urlencoded 으로 모든 문자를 인코딩한다. 파일 업로드는 인코딩

processData ; 일반적으로 서버에 전달되는 데이터는 query string 형태로 전달되기에 false 로 적어준다.

contentType ; default값이 "application/x-www-form-urlencoded; charset=UTF-8"  이다. "multipart/form-data" 로 전송되도록 false 를 적어준다.

